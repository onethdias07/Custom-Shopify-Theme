{% comment %}
  Featured Collection Section - Minimalist Theme
  Displays products from a selected collection with customizable content
{% endcomment %}

<section class="featured-collection-section"
  style="padding-top: {{ section.settings.section_padding_top }}px; 
         padding-bottom: {{ section.settings.section_padding_bottom }}px; 
         background-color: {{ section.settings.section_bg_color }};">
  <div class="container">
    
    {% if section.settings.heading != blank or section.settings.subheading != blank %}
      <div class="section-header" style="margin-bottom: {{ section.settings.header_spacing }}px;">
        {% if section.settings.heading != blank %}
          <h2 class="section-title" style="color: {{ section.settings.heading_color }};">{{ section.settings.heading }}</h2>
        {% endif %}
        
        {% if section.settings.subheading != blank %}
          <p class="section-subtitle" style="color: {{ section.settings.subheading_color }};">{{ section.settings.subheading }}</p>
        {% endif %}
      </div>
    {% endif %}

    {% if section.settings.collection != blank %}
      {% assign collection = collections[section.settings.collection] %}
      {% assign products_to_show = section.settings.products_to_show | default: 4 %}
      
      {% if collection.products.size > 0 %}
        <div class="products-grid products-grid--{{ section.settings.grid_columns }}" 
             style="gap: {{ section.settings.grid_gap }}px;">
          {% for product in collection.products limit: products_to_show %}
            <a href="{{ product.url }}" class="product-card-link">
              <div class="product-card" 
                   style="border-radius: {{ section.settings.card_border_radius }}px;
                          {% if section.settings.card_border %}border: 1px solid {{ section.settings.card_border_color }};{% else %}border: none;{% endif %}
                          {% if section.settings.card_shadow %}box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);{% endif %}">
                
                <div class="product-image">
                  {% if product.featured_image %}
                    <img src="{{ product.featured_image | image_url: width: 500 }}" 
                         alt="{{ product.featured_image.alt | escape }}" 
                         loading="lazy">
                  {% else %}
                    <div class="product-image-placeholder">
                      <svg width="100" height="100" viewBox="0 0 100 100" fill="none">
                        <rect width="100" height="100" fill="#f5f5f5"/>
                        <path d="M30 35h40v30H30z" stroke="#ddd" stroke-width="2" fill="none"/>
                      </svg>
                    </div>
                  {% endif %}
                  
                  {% if product.available == false %}
                    <div class="product-badge product-badge--sold-out">
                      Sold Out
                    </div>
                  {% elsif product.compare_at_price > product.price %}
                    <div class="product-badge product-badge--sale">
                      Sale
                    </div>
                  {% endif %}
                </div>

                <div class="product-info" style="padding: {{ section.settings.card_padding_top }}px {{ section.settings.card_padding_right }}px {{ section.settings.card_padding_bottom }}px {{ section.settings.card_padding_left }}px;">
                  <h3 class="product-title">{{ product.title }}</h3>
                  
                  <div class="product-price">
                    {% if product.compare_at_price > product.price %}
                      <span class="price price--sale">{{ product.price | money }}</span>
                      <span class="price price--compare">{{ product.compare_at_price | money }}</span>
                    {% else %}
                      <span class="price">{{ product.price | money }}</span>
                    {% endif %}
                  </div>

                  {% if section.settings.show_vendor and product.vendor != blank %}
                    <p class="product-vendor">{{ product.vendor }}</p>
                  {% endif %}
                </div>
                
              </div>
            </a>
          {% endfor %}
        </div>

        {% if section.settings.show_view_all and collection.products_count > products_to_show %}
          <div class="section-footer">
            <a href="{{ collection.url }}" class="btn btn--secondary">
              {{ section.settings.button_text | default: 'View All' }} 
              ({{ collection.products_count }})
            </a>
          </div>
        {% endif %}

      {% else %}
        <div class="collection-empty">
          <p>This collection is empty. Add some products to display them here.</p>
        </div>
      {% endif %}

    {% else %}
      <div class="collection-placeholder">
        <p>Please select a collection to display products. Go to theme settings to choose a collection for this section.</p>
      </div>
    {% endif %}

  </div>
</section>

{% schema %}
{
  "name": "Featured Collection",
  "tag": "section",
  "class": "featured-collection-wrapper",
  "settings": [
    {
      "type": "header",
      "content": "Collection Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Products"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading",
      "default": "Discover our most popular items"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "label": "Products to Show",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 4
    },
    {
      "type": "select",
      "id": "grid_columns",
      "label": "Grid Columns",
      "options": [
        {
          "value": "2",
          "label": "2 Columns"
        },
        {
          "value": "3",
          "label": "3 Columns"
        },
        {
          "value": "4",
          "label": "4 Columns"
        }
      ],
      "default": "4"
    },
    {
      "type": "header",
      "content": "Display Options"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show Product Vendor",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show View All Button",
      "default": true
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "View All Button Text",
      "default": "View All",
      "visible_if": "{{ section.settings.show_view_all }}"
    },
    {
      "type": "header",
      "content": "Section Spacing"
    },
    {
      "type": "range",
      "id": "section_padding_top",
      "label": "Top Padding",
      "min": 0,
      "max": 120,
      "step": 10,
      "unit": "px",
      "default": 80
    },
    {
      "type": "range",
      "id": "section_padding_bottom",
      "label": "Bottom Padding",
      "min": 0,
      "max": 120,
      "step": 10,
      "unit": "px",
      "default": 80
    },
    {
      "type": "range",
      "id": "header_spacing",
      "label": "Header Bottom Spacing",
      "min": 20,
      "max": 100,
      "step": 10,
      "unit": "px",
      "default": 60
    },
    {
      "type": "range",
      "id": "grid_gap",
      "label": "Grid Gap",
      "min": 10,
      "max": 60,
      "step": 5,
      "unit": "px",
      "default": 40
    },
    {
      "type": "header",
      "content": "Product Card Styling"
    },
    {
      "type": "range",
      "id": "card_padding_top",
      "label": "Card Content Top Padding",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "card_padding_right",
      "label": "Card Content Right Padding",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "px",
      "default": 25
    },
    {
      "type": "range",
      "id": "card_padding_bottom",
      "label": "Card Content Bottom Padding",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "card_padding_left",
      "label": "Card Content Left Padding",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "px",
      "default": 25
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "label": "Card Border Radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "default": 0
    },
    {
      "type": "checkbox",
      "id": "card_shadow",
      "label": "Enable Card Shadow",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "card_border",
      "label": "Enable Card Border",
      "default": true
    },
    {
      "type": "color",
      "id": "card_border_color",
      "label": "Card Border Color",
      "default": "#e8e8e8",
      "visible_if": "{{ section.settings.card_border }}"
    },
    {
      "type": "header",
      "content": "Background & Colors"
    },
    {
      "type": "color",
      "id": "section_bg_color",
      "label": "Section Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#2c2c2c"
    },
    {
      "type": "color",
      "id": "subheading_color",
      "label": "Subheading Color",
      "default": "#666666"
    }
  ],
  "presets": [
    {
      "name": "Featured Collection",
      "category": "General"
    }
  ]
}
{% endschema %}
